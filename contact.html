<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Contact Chief Engineering Construction - Get in touch for your construction and engineering needs in Zambia">
    <meta name="keywords" content="contact, construction, engineering, Zambia, quote, consultation">
    <title>Contact Us | Chief Engineering Construction</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- External CSS -->
    <link rel="stylesheet" href="contact.css">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container">
            <a class="navbar-brand fw-bold" href="index.html">Chief Engineering Construction</a>
            <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="service.html">Services</a></li>
                    <li class="nav-item"><a class="nav-link" href="project.html">Projects</a></li>
                    <li class="nav-item"><a class="nav-link" href="about.html">About</a></li>
                    <li class="nav-item"><a class="nav-link active" href="contact.html">Contact</a></li>
                    <li class="nav-item"><a class="nav-link" href="admin-login.html">Admin</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- ========== HERO SECTION ========== -->
    <section class="hero-section">
        <div class="container">
            <h1 class="display-3">Get In Touch</h1>
            <p class="lead">We're here to bring your construction vision to life. Contact us today for a free consultation.</p>
        </div>
    </section>

    <!-- ========== CONTACT INFO CARDS ========== -->
    <section class="contact-section">
        <div class="container">
            <div class="row g-4">
                <!-- Phone Card -->
                <div class="col-md-4">
                    <div class="contact-card scroll-reveal">
                        <div class="contact-icon">
                            <i class="bi bi-telephone-fill"></i>
                        </div>
                        <h5>Call Us</h5>
                        <p class="text-muted">Mon-Fri: 8:00 AM - 5:00 PM</p>
                        <a href="tel:+260975479564" class="contact-link">+260 975 479 564</a>
                    </div>
                </div>

                <!-- Email Card -->
                <div class="col-md-4">
                    <div class="contact-card scroll-reveal">
                        <div class="contact-icon">
                            <i class="bi bi-envelope-fill"></i>
                        </div>
                        <h5>Email Us</h5>
                        <p class="text-muted">Response within 24 hours</p>
                        <a href="mailto:martinmwisa3@gmail.com" class="contact-link">martinmwisa3@gmail.com</a>
                    </div>
                </div>

                <!-- Location Card -->
                <div class="col-md-4">
                    <div class="contact-card scroll-reveal">
                        <div class="contact-icon">
                            <i class="bi bi-geo-alt-fill"></i>
                        </div>
                        <h5>Visit Us</h5>
                        <p class="text-muted">Our Office Location</p>
                        <p class="contact-link">Lusaka, Zambia</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ========== CONTACT FORM SECTION ========== -->
    <section class="form-section">
        <div class="container">
            <div class="section-title-wrapper">
                <h2 class="section-title display-5">Send Us a Message</h2>
                <p class="section-subtitle">Fill out the form below and we'll get back to you as soon as possible</p>
            </div>
            
            <div class="row justify-content-center">
                <div class="col-lg-10">
                    <div class="contact-form">
                        <!-- Connection Status Alert (hidden by default) -->
                        <div id="connectionAlert" class="alert alert-danger d-none" role="alert">
                            <i class="bi bi-exclamation-triangle me-2"></i>
                            <span id="connectionMessage"></span>
                        </div>

                        <form id="contactForm">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="firstName" class="form-label">First Name *</label>
                                    <input type="text" class="form-control" id="firstName" placeholder="Martin" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="lastName" class="form-label">Last Name *</label>
                                    <input type="text" class="form-control" id="lastName" placeholder="Mwisa" required>
                                </div>

                                <div class="col-md-6">
                                    <label for="email" class="form-label">Email *</label>
                                    <input type="email" class="form-control" id="email" placeholder="martin@example.com" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="phone" class="form-label">Phone Number</label>
                                    <input type="tel" class="form-control" id="phone" placeholder="+260 9XX XXX XXX">
                                </div>

                                <div class="col-12">
                                    <label for="service" class="form-label">Service Interested In *</label>
                                    <select class="form-select" id="service" required>
                                        <option value="">Select a service...</option>
                                        <option value="residential">Residential Construction</option>
                                        <option value="commercial">Commercial Construction</option>
                                        <option value="renovation">Renovation & Refurbishment</option>
                                        <option value="infrastructure">Infrastructure Development</option>
                                        <option value="project-management">Project Management</option>
                                        <option value="design">Design & Consultation</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>

                                <div class="col-12">
                                    <label for="message" class="form-label">Message *</label>
                                    <textarea class="form-control" id="message" rows="6" 
                                              placeholder="Tell us about your project requirements, timeline, and any specific details..." 
                                              required></textarea>
                                </div>

                                <div class="col-12 text-center mt-4">
                                    <button type="submit" class="btn-submit" id="submitBtn">
                                        Send Message 
                                    </button>
                                </div>
                            </div>
                        </form>

                        <!-- Success Message (hidden by default) -->
                        <div id="successMessage" class="alert alert-success mt-4 d-none" role="alert">
                            <i class="bi bi-check-circle me-2"></i>
                            <strong>Thank you for your message!</strong> We will get back to you within 24 hours.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ========== MAP SECTION (placeholder) ========== -->
    <section class="map-section">
        <div class="container">
            <div class="map-container">
                <i class="bi bi-map-fill me-2" style="font-size: 2rem;"></i> 
                Interactive Map â€“ Lusaka, Zambia (coming soon)
            </div>
        </div>
    </section>

    <!-- WhatsApp Button -->
    <a href="https://wa.link/uvjg0r" class="whatsapp-float btn btn-success position-fixed bottom-0 end-0 m-4 rounded-circle shadow-lg" target="_blank" rel="noopener noreferrer" aria-label="Chat on WhatsApp">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="white" viewBox="0 0 16 16">
            <path d="M13.601 2.326A7.854 7.854 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.933 7.933 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.898 7.898 0 0 0 13.6 2.326zM7.994 14.521a6.573 6.573 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.557 6.557 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592zm3.615-4.934c-.197-.099-1.17-.578-1.353-.646-.182-.065-.315-.099-.445.099-.133.197-.513.646-.627.775-.114.133-.232.148-.43.05-.197-.1-.836-.308-1.592-.985-.59-.525-.985-1.175-1.103-1.372-.114-.198-.011-.304.088-.403.087-.088.197-.232.296-.346.1-.114.133-.198.198-.33.065-.134.034-.248-.015-.347-.05-.099-.445-1.076-.612-1.47-.16-.389-.323-.335-.445-.34-.114-.007-.247-.007-.38-.007a.729.729 0 0 0-.529.247c-.182.198-.691.677-.691 1.654 0 .977.71 1.916.81 2.049.098.133 1.394 2.132 3.383 2.992.47.205.84.326 1.129.418.475.152.904.129 1.246.08.38-.058 1.171-.48 1.338-.943.164-.464.164-.86.114-.943-.049-.084-.182-.133-.38-.232z"/>
        </svg>
    </a>

    <!-- ========== FOOTER ========== -->
    <footer>
        <div class="container">
            <div class="row gy-4">
                <div class="col-md-4">
                    <h5 class="d-flex align-items-center mb-3">
                        Chief Engineering
                    </h5>
                    <p class="text-secondary mb-3">Building your dreams with quality, safety, and integrity. Your trusted partner in construction excellence across Zambia.</p>
                    <div class="d-flex gap-2">
                        <a href="https://www.facebook.com/people/Young-Engineers-construction-company/61565455101839/" class="social-link" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="social-link" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="#" class="social-link" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
                <div class="col-md-4">
                    <h6>Quick Links</h6>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="index.html"><i class="bi bi-chevron-right me-1"></i>Home</a></li>
                        <li class="mb-2"><a href="service.html"><i class="bi bi-chevron-right me-1"></i>Services</a></li>
                        <li class="mb-2"><a href="project.html"><i class="bi bi-chevron-right me-1"></i>Projects</a></li>
                        <li class="mb-2"><a href="about.html"><i class="bi bi-chevron-right me-1"></i>About Us</a></li>
                        <li class="mb-2"><a href="contact.html"><i class="bi bi-chevron-right me-1"></i>Contact</a></li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <h6>Contact Us</h6>
                    <p class="text-secondary mb-2">
                        <i class="fas fa-phone text-warning me-2"></i>
                        <a href="tel:+260975479564">+260 975 479 564</a>
                    </p>
                    <p class="text-secondary mb-2">
                        <i class="fas fa-envelope text-warning me-2"></i>
                        <a href="mailto:martinmwisa3@gmail.com">martinmwisa3@gmail.com</a>
                    </p>
                    <p class="text-secondary mb-0">
                        <i class="fas fa-map-marker-alt text-warning me-2"></i>
                        Lusaka, Zambia
                    </p>
                </div>
            </div>
            <hr>
            <p class="text-center text-secondary small mb-0">
                &copy; 2026 Chief Engineering Construction. All rights reserved | 
                Designed by <a href="https://mwisa-the-dev-io.vercel.app/" class="text-warning">Jones Mwisa</a>
            </p>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Scroll reveal simple script -->
    <script>
        (function() {
            const reveals = document.querySelectorAll('.scroll-reveal');
            function checkReveal() {
                for (let el of reveals) {
                    const windowHeight = window.innerHeight;
                    const revealTop = el.getBoundingClientRect().top;
                    const revealPoint = 150;
                    if (revealTop < windowHeight - revealPoint) {
                        el.classList.add('revealed');
                    }
                }
            }
            window.addEventListener('scroll', checkReveal);
            window.addEventListener('load', checkReveal);
        })();
    </script>

    <!-- Firebase SDK with improved error handling -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, collection, addDoc, Timestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBO1Qlu66KtqzC0XrnjgJyhoKLgOMUU1zo",
            authDomain: "chiefengineering-49745.firebaseapp.com",
            projectId: "chiefengineering-49745",
            storageBucket: "chiefengineering-49745.firebasestorage.app",
            messagingSenderId: "610373373596",
            appId: "1:610373373596:web:d8ff0b7e89c917981c2759"
        };

        // DOM Elements
        const form = document.getElementById("contactForm");
        const submitBtn = document.getElementById("submitBtn");
        const successMsg = document.getElementById("successMessage");
        const connectionAlert = document.getElementById("connectionAlert");
        const connectionMessage = document.getElementById("connectionMessage");

        // Initialize Firebase with error handling
        let db;
        try {
            const app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            console.log("Firebase initialized successfully");
        } catch (error) {
            console.error("Firebase initialization error:", error);
            showError("Failed to initialize Firebase. Please check your configuration.");
        }

        function showError(message) {
            connectionMessage.textContent = message;
            connectionAlert.classList.remove("d-none");
            setTimeout(() => {
                connectionAlert.classList.add("d-none");
            }, 5000);
        }

        function showSuccess() {
            successMsg.classList.remove("d-none");
            setTimeout(() => {
                successMsg.classList.add("d-none");
            }, 5000);
        }

        // Test Firestore connection by trying to write a test document
        async function testFirestoreConnection() {
            try {
                const testCollection = collection(db, "connection_test");
                await addDoc(testCollection, {
                    test: true,
                    timestamp: Timestamp.now()
                });
                console.log("Firestore connection successful");
                return true;
            } catch (error) {
                console.error("Firestore connection test failed:", error);
                showError("Cannot connect to Firestore. Please check your Firestore rules and permissions.");
                return false;
            }
        }

        // Handle form submission
        form.addEventListener("submit", async (e) => {
            e.preventDefault();

            // Collect form data
            const formData = {
                firstName: document.getElementById("firstName").value.trim(),
                lastName: document.getElementById("lastName").value.trim(),
                email: document.getElementById("email").value.trim(),
                phone: document.getElementById("phone").value.trim(),
                service: document.getElementById("service").value,
                message: document.getElementById("message").value.trim(),
                timestamp: Timestamp.now(),
                status: "unread"
            };

            // Validate required fields
            if (!formData.firstName || !formData.lastName || !formData.email || !formData.service || !formData.message) {
                showError("Please fill all required fields.");
                return;
            }

            // Validate email format
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(formData.email)) {
                showError("Please enter a valid email address.");
                return;
            }

            // Disable button and show loading state
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>Sending...';

            try {
                // Test connection first (optional - remove if causing issues)
                // await testFirestoreConnection();

                // Save to Firestore
                console.log("Attempting to save message to Firestore...");
                const docRef = await addDoc(collection(db, "messages"), formData);
                console.log("Message saved successfully with ID:", docRef.id);
                
                // Show success message
                showSuccess();
                
                // Reset form
                form.reset();

            } catch (error) {
                console.error("Error sending message:", error);
                
                // More detailed error message based on error type
                let errorMessage = "Failed to send message. ";
                
                if (error.code === "permission-denied") {
                    errorMessage += "Firestore permission denied. Please check your security rules.";
                } else if (error.code === "unavailable") {
                    errorMessage += "Network error. Please check your internet connection.";
                } else if (error.code === "not-found") {
                    errorMessage += "Firestore database not found. Please check your project ID.";
                } else {
                    errorMessage += error.message || "Unknown error occurred.";
                }
                
                showError(errorMessage);
            } finally {
                // Re-enable button
                submitBtn.disabled = false;
                submitBtn.innerHTML = 'Send Message';
            }
        });

        // Test connection on page load
        setTimeout(() => {
            if (db) {
                testFirestoreConnection();
            }
        }, 1000);
    </script>
</body>
</html>